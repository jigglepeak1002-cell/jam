<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bear Maze â€“ Mobile First</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: #000;
  overflow: hidden;
  font-family: Arial, sans-serif;
  touch-action: manipulation;
}

/* GAME WRAPPER */
#game {
  width: 100vw;
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* CANVAS AREA */
#canvasWrap {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
}

canvas {
  background: #111;
}

/* CONTROLS */
.controls {
  height: 110px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 14px;
  background: #000;
}

.controls button {
  width: 72px;
  height: 72px;
  font-size: 30px;
  border-radius: 50%;
  border: none;
  background: #222;
  color: #fff;
}

.controls button:active {
  background: #555;
}
</style>
</head>

<body>

<div id="game">

  <div id="canvasWrap">
    <canvas id="canvas"></canvas>
  </div>

  <div class="controls">
    <button data-dir="left">â¬…</button>
    <button data-dir="up">â¬†</button>
    <button data-dir="down">â¬‡</button>
    <button data-dir="right">âž¡</button>
  </div>

</div>

<script>
/* ---------------- CANVAS ---------------- */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  const size = Math.min(window.innerWidth, window.innerHeight - 110);
  canvas.width = size;
  canvas.height = size;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

/* ---------------- MAZE ---------------- */
const SIZE = 21;
let TILE = canvas.width / SIZE;

const maze = Array.from({ length: SIZE }, () => Array(SIZE).fill(1));

function carve(x, y) {
  maze[y][x] = 0;
  const dirs = [[2,0],[-2,0],[0,2],[0,-2]].sort(() => Math.random() - 0.5);
  for (const [dx, dy] of dirs) {
    const nx = x + dx;
    const ny = y + dy;
    if (nx > 0 && ny > 0 && nx < SIZE-1 && ny < SIZE-1 && maze[ny][nx] === 1) {
      maze[y + dy/2][x + dx/2] = 0;
      carve(nx, ny);
    }
  }
}
carve(1,1);

const player = { x: 1, y: 1 };
const mother = { x: SIZE-2, y: SIZE-2 };

/* ---------------- DRAW ---------------- */
function draw() {
  TILE = canvas.width / SIZE;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  for (let y=0;y<SIZE;y++) {
    for (let x=0;x<SIZE;x++) {
      if (maze[y][x] === 1) {
        ctx.fillStyle = "#000";
        ctx.fillRect(x*TILE, y*TILE, TILE, TILE);
      }
    }
  }

  // Baby Bear
  ctx.fillStyle = "#8B4513";
  ctx.beginPath();
  ctx.arc(
    player.x*TILE + TILE/2,
    player.y*TILE + TILE/2,
    TILE*0.35,
    0, Math.PI*2
  );
  ctx.fill();

  // Mother Bear
  ctx.fillStyle = "#FFD700";
  ctx.beginPath();
  ctx.arc(
    mother.x*TILE + TILE/2,
    mother.y*TILE + TILE/2,
    TILE*0.4,
    0, Math.PI*2
  );
  ctx.fill();
}

/* ---------------- MOVE ---------------- */
let moveDir = null;
let lastMove = 0;

function tryMove(dx, dy) {
  const nx = player.x + dx;
  const ny = player.y + dy;
  if (maze[ny]?.[nx] !== 0) return;

  player.x = nx;
  player.y = ny;

  if (nx === mother.x && ny === mother.y) {
    setTimeout(() => {
      alert("ðŸ» Reunited with Mother!");
      location.reload();
    }, 50);
  }
}

/* ---------------- LOOP ---------------- */
function loop(time) {
  if (moveDir && time - lastMove > 140) {
    lastMove = time;
    if (moveDir === "up") tryMove(0,-1);
    if (moveDir === "down") tryMove(0,1);
    if (moveDir === "left") tryMove(-1,0);
    if (moveDir === "right") tryMove(1,0);
  }

  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ---------------- MOBILE CONTROLS ---------------- */
document.querySelectorAll(".controls button").forEach(btn=>{
  btn.addEventListener("pointerdown",()=>{
    moveDir = btn.dataset.dir;
  });
  btn.addEventListener("pointerup",()=> moveDir = null);
  btn.addEventListener("pointerleave",()=> moveDir = null);
});

/* ---------------- KEYBOARD (PC) ---------------- */
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp") tryMove(0,-1);
  if(e.key==="ArrowDown") tryMove(0,1);
  if(e.key==="ArrowLeft") tryMove(-1,0);
  if(e.key==="ArrowRight") tryMove(1,0);
});
</script>

</body>
</html>